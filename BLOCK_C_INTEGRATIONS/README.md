# üîó –ë–õ–û–ö C: –í–ù–ï–®–ù–ò–ï –ò–ù–¢–ï–ì–†–ê–¶–ò–ò

## üéØ –¶–ï–õ–¨ –ë–õ–û–ö–ê
–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤—Å–µ—Ö –≤–Ω–µ—à–Ω–∏—Ö —Å–µ—Ä–≤–∏—Å–æ–≤ –≤ –µ–¥–∏–Ω—É—é —ç–∫–æ—Å–∏—Å—Ç–µ–º—É.

## üîó –°–•–ï–ú–ê –ò–ù–¢–ï–ì–†–ê–¶–ò–ô
FLEXBE (–¥–æ–º–∞-—Ü–µ–Ω—ã.—Ä—Ñ)
‚Üì Umnico Webhook
PROTALK –ë–û–¢ (–±–æ—Ç-–ø—Ä–æ–≤–æ–¥–Ω–∏–∫)
‚Üì Database API
POSTGRESQL (–±–∞–∑–∞ –ø–∞—Ä—Ç–Ω–µ—Ä–æ–≤)
‚Üë Tilda Webhook
TILDA (–ø–∞—Ä—Ç–Ω–µ—Ä.–¥–æ–º–∞-—Ü–µ–Ω—ã.—Ä—Ñ)

text

## üìÅ –ö–û–ú–ü–û–ù–ï–ù–¢–´ –ë–õ–û–ö–ê

### 1. Webhook Handlers (`webhook_handlers.py`)
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Ö–æ–¥—è—â–∏—Ö –≤–µ–±—Ö—É–∫–æ–≤ –æ—Ç –≤–Ω–µ—à–Ω–∏—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
- –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–æ–¥–ø–∏—Å–µ–π
- –ú–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è —Å–æ–±—ã—Ç–∏–π

### 2. FNS API Client (`fns_api_client.py`)
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å API –§–µ–¥–µ—Ä–∞–ª—å–Ω–æ–π –ù–∞–ª–æ–≥–æ–≤–æ–π –°–ª—É–∂–±—ã
- –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è –ò–ù–ù –∫–æ–º–ø–∞–Ω–∏–π
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —é—Ä–∏–¥–∏—á–µ—Å–∫–æ–≥–æ —Å—Ç–∞—Ç—É—Å–∞

### 3. Protalk Connector (`protalk_connector.py`)
- –†–∞–±–æ—Ç–∞ —Å –±–æ—Ç–∞–º–∏-–ø—Ä–æ–≤–æ–¥–Ω–∏–∫–∞–º–∏ Protalk
- –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º
- –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–∞—Ä—Ç–æ—á–µ–∫ –ø–∞—Ä—Ç–Ω–µ—Ä–æ–≤

### 4. Umnico Connector (`umnico_connector.py`)
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —á–∞—Ç-–≤–∏–¥–∂–µ—Ç–æ–º –Ω–∞ —Å–∞–π—Ç–µ
- –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π —á–µ—Ä–µ–∑ –≤–∏–¥–∂–µ—Ç
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–∏–∞–ª–æ–≥–∞–º–∏

### 5. Tilda Connector (`tilda_connector.py`)
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –ª–∏—á–Ω—ã–º –∫–∞–±–∏–Ω–µ—Ç–æ–º –Ω–∞ Tilda
- –°–æ–∑–¥–∞–Ω–∏–µ —Å—Ç—Ä–∞–Ω–∏—Ü –ø–∞—Ä—Ç–Ω–µ—Ä–æ–≤
- –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–æ—Ä–º —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏

### 6. Payment Gateway (`payment_gateway.py`)
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –ø–ª–∞—Ç–µ–∂–Ω—ã–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ–ø–ª–∞—Ç—ã –ø–æ–¥–ø–∏—Å–æ–∫
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–¥–ø–∏—Å–∫–∞–º–∏

### 7. Email Service (`email_service.py`)
- –û—Ç–ø—Ä–∞–≤–∫–∞ email —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- –®–∞–±–ª–æ–Ω—ã –ø–∏—Å–µ–º
- –ú–∞—Å—Å–æ–≤—ã–µ —Ä–∞—Å—Å—ã–ª–∫–∏

## üöÄ –ù–ê–°–¢–†–û–ô–ö–ê –ò–ù–¢–ï–ì–†–ê–¶–ò–ô

### 1. API –§–ù–°
```bash
# –ü–æ–ª—É—á–µ–Ω–∏–µ API –∫–ª—é—á–∞
# 1. –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å –Ω–∞ api-fns.ru
# 2. –ü–æ–ª—É—á–∏—Ç–µ API –∫–ª—é—á
# 3. –î–æ–±–∞–≤—å—Ç–µ –≤ .env:
FNS_API_KEY=–≤–∞—à_–∫–ª—é—á_—Ñ–Ω—Å
2. Protalk –±–æ—Ç—ã
bash
# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≤–µ–±—Ö—É–∫–æ–≤
# 1. –°–æ–∑–¥–∞–π—Ç–µ –±–æ—Ç–æ–≤ –≤ Protalk
# 2. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –≤–µ–±—Ö—É–∫–∏ –Ω–∞ –≤–∞—à —Å–µ—Ä–≤–µ—Ä
# 3. –î–æ–±–∞–≤—å—Ç–µ –≤ .env:
PROTALK_CLIENT_BOT_TOKEN=—Ç–æ–∫–µ–Ω_–±–æ—Ç–∞_–∫–ª–∏–µ–Ω—Ç–∞
PROTALK_PARTNER_BOT_TOKEN=—Ç–æ–∫–µ–Ω_–±–æ—Ç–∞_–ø–∞—Ä—Ç–Ω–µ—Ä–∞
PROTALK_WEBHOOK_SECRET=—Å–µ–∫—Ä–µ—Ç_–≤–µ–±—Ö—É–∫–∞
3. Umnico (—á–∞—Ç –Ω–∞ —Å–∞–π—Ç–µ)
bash
# 1. –°–æ–∑–¥–∞–π—Ç–µ –≤–∏–¥–∂–µ—Ç –≤ Umnico
# 2. –ü–æ–ª—É—á–∏—Ç–µ —Ç–æ–∫–µ–Ω –≤–∏–¥–∂–µ—Ç–∞
# 3. –î–æ–±–∞–≤—å—Ç–µ –≤ .env:
UMNICO_WIDGET_TOKEN=—Ç–æ–∫–µ–Ω_–≤–∏–¥–∂–µ—Ç–∞
UMNICO_API_KEY=–∫–ª—é—á_api
4. Tilda (–ª–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç)
bash
# 1. –°–æ–∑–¥–∞–π—Ç–µ –ø—Ä–æ–µ–∫—Ç –≤ Tilda
# 2. –ü–æ–ª—É—á–∏—Ç–µ –∫–ª—é—á–∏ API
# 3. –î–æ–±–∞–≤—å—Ç–µ –≤ .env:
TILDA_PUBLIC_KEY=–ø—É–±–ª–∏—á–Ω—ã–π_–∫–ª—é—á
TILDA_SECRET_KEY=—Å–µ–∫—Ä–µ—Ç–Ω—ã–π_–∫–ª—é—á
5. –ü–ª–∞—Ç–µ–∂–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã
bash
# –ÆKassa (–Ø–Ω–¥–µ–∫—Å.–ö–∞—Å—Å–∞)
YUKASSA_SHOP_ID=–∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä_–º–∞–≥–∞–∑–∏–Ω–∞
YUKASSA_SECRET_KEY=—Å–µ–∫—Ä–µ—Ç–Ω—ã–π_–∫–ª—é—á

# CloudPayments
CLOUDPAYMENTS_PUBLIC_ID=–ø—É–±–ª–∏—á–Ω—ã–π_id
CLOUDPAYMENTS_API_SECRET=—Å–µ–∫—Ä–µ—Ç_api
6. Email —Ä–∞—Å—Å—ã–ª–∫–∏
bash
# –ù–∞—Å—Ç—Ä–æ–π–∫–∏ SMTP
SMTP_HOST=smtp.yandex.ru
SMTP_PORT=587
SMTP_USER=–≤–∞—à_email
SMTP_PASSWORD=–ø–∞—Ä–æ–ª—å
EMAIL_FROM=noreply@–¥–æ–º–∞-—Ü–µ–Ω—ã.—Ä—Ñ
üìä API –ò–ù–¢–ï–ì–†–ê–¶–ò–ò
–í–µ–±—Ö—É–∫–∏ –¥–ª—è –ø—Ä–∏–µ–º–∞ –¥–∞–Ω–Ω—ã—Ö:
POST /webhook/protalk - —Å–æ–æ–±—â–µ–Ω–∏—è –æ—Ç Protalk –±–æ—Ç–æ–≤

POST /webhook/umnico - —Å–æ–æ–±—â–µ–Ω–∏—è –∏–∑ —á–∞—Ç–∞ –Ω–∞ —Å–∞–π—Ç–µ

POST /webhook/tilda - –¥–∞–Ω–Ω—ã–µ –∏–∑ –ª–∏—á–Ω–æ–≥–æ –∫–∞–±–∏–Ω–µ—Ç–∞

POST /webhook/payment - —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ—Ç –ø–ª–∞—Ç–µ–∂–Ω—ã—Ö —Å–∏—Å—Ç–µ–º

–ü—Ä–æ–≤–µ—Ä–∫–∞ –ò–ù–ù —á–µ—Ä–µ–∑ –§–ù–°:
python
from BLOCK_C_INTEGRATIONS import FNSAPIClient

client = FNSAPIClient(api_key='–≤–∞—à_–∫–ª—é—á')
result = client.check_inn('7712345678')
–û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π –≤ –±–æ—Ç:
python
from BLOCK_C_INTEGRATIONS import ProtalkConnector

connector = ProtalkConnector(api_key='—Ç–æ–∫–µ–Ω_–±–æ—Ç–∞')
result = connector.send_message(
    chat_id='123456',
    text='–ü—Ä–∏–≤–µ—Ç! –í–æ—Ç –≤–∞—à–∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:'
)
–û—Ç–ø—Ä–∞–≤–∫–∞ email:
python
from BLOCK_C_INTEGRATIONS import EmailService

email_service = EmailService(
    smtp_host='smtp.yandex.ru',
    smtp_port=587,
    smtp_user='user@yandex.ru',
    smtp_password='password',
    email_from='noreply@–¥–æ–º–∞-—Ü–µ–Ω—ã.—Ä—Ñ'
)

result = email_service.send_partner_welcome_email(
    partner_email='partner@example.com',
    partner_data={...}
)
üß™ –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï
–¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ:
python
# –¢–µ—Å—Ç–æ–≤—ã–π –ò–ù–ù –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏
TEST_INN = '7712345678'

# –¢–µ—Å—Ç–æ–≤—ã–π webhook payload
TEST_WEBHOOK = {
    'type': 'message',
    'user': {'id': 'test_user'},
    'message': {'text': '–•–æ—á—É —Å—Ç–∞—Ç—å –ø–∞—Ä—Ç–Ω–µ—Ä–æ–º'}
}
–ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤:
bash
cd tests/test_block_c
python -m pytest test_integrations.py -v
üîí –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–¨
–í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è –≤–µ–±—Ö—É–∫–æ–≤:
–í—Å–µ –≤–µ–±—Ö—É–∫–∏ –¥–æ–ª–∂–Ω—ã –∏–º–µ—Ç—å –≤–∞–ª–∏–¥–Ω—É—é –ø–æ–¥–ø–∏—Å—å

–ü—Ä–æ–≤–µ—Ä–∫–∞ timestamp –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è replay-–∞—Ç–∞–∫

–í–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–æ—Ä–º–∞—Ç–∞ –¥–∞–Ω–Ω—ã—Ö

–ó–∞—â–∏—Ç–∞ API –∫–ª—é—á–µ–π:
–ö–ª—é—á–∏ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è

–ù–∏–∫–æ–≥–¥–∞ –Ω–µ –∫–æ–º–º–∏—Ç—è—Ç—Å—è –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π

–†–µ–≥—É–ª—è—Ä–Ω–∞—è —Ä–æ—Ç–∞—Ü–∏—è –∫–ª—é—á–µ–π

–®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö:
–í—Å–µ –ø–ª–∞—Ç–µ–∂–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —à–∏—Ñ—Ä—É—é—Ç—Å—è

–ö–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –Ω–µ –ª–æ–≥–∏—Ä—É–µ—Ç—Å—è

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è HTTPS –¥–ª—è –≤—Å–µ—Ö API –≤—ã–∑–æ–≤–æ–≤

üìà –ú–û–ù–ò–¢–û–†–ò–ù–ì
–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:
–í—Å–µ API –≤—ã–∑–æ–≤—ã –ª–æ–≥–∏—Ä—É—é—Ç—Å—è

–û—à–∏–±–∫–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞

–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è API

–ú–µ—Ç—Ä–∏–∫–∏:
–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —É—Å–ø–µ—à–Ω—ã—Ö/–Ω–µ—É—Å–ø–µ—à–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤

–í—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞ –≤–Ω–µ—à–Ω–∏—Ö API

–ö–≤–æ—Ç–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è API

–ê–ª–µ—Ä—Ç–∏–Ω–≥:
–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö API

–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –æ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ –∫–≤–æ—Ç

–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ —Å–µ—Ä–≤–∏—Å–æ–≤

üÜò –†–ï–®–ï–ù–ò–ï –ü–†–û–ë–õ–ï–ú
–ß–∞—Å—Ç—ã–µ –ø—Ä–æ–±–ª–µ–º—ã:
–ò—Å—Ç–µ–∫ —Å—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è API –∫–ª—é—á–∞ - –æ–±–Ω–æ–≤–∏—Ç–µ –∫–ª—é—á –≤ .env

–ü—Ä–µ–≤—ã—à–µ–Ω–∞ –∫–≤–æ—Ç–∞ –∑–∞–ø—Ä–æ—Å–æ–≤ - –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–∏–º–∏—Ç—ã API

–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –ø–æ–¥–ø–∏—Å—å –≤–µ–±—Ö—É–∫–∞ - –ø—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á

–û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ SMTP - –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ—á—Ç—ã

–û—Ç–ª–∞–¥–∫–∞:
python
# –í–∫–ª—é—á–µ–Ω–∏–µ –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
import logging
logging.basicConfig(level=logging.DEBUG)

# –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
from BLOCK_C_INTEGRATIONS import FNSAPIClient
client = FNSAPIClient(api_key='test')
result = client.check_inn('1234567890')
print(result)
